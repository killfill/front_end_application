<html>
	
	<head>

		<link rel="stylesheet" href='../layout.css' />
		<link rel="stylesheet" href='../boxen.css' />
	
		<script src='//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/JSXTransformer.js'></script>
		<script src='//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/react.min.js'></script>

		<script type="text/jsx">
			/** @jsx React.DOM */

			var Sidebar = React.createClass({
				getInitialState: function() {
					return {
						selected: [],
						founded: [],
					}
				},
				handleStockSelection: function(stock) {
					console.log('--->', stock)
					var sels = this.state.selected
					sels.push(stock)
					this.setState({selected: sels})
				},
				handleStockUnSelection: function(stock) {
					console.log('unselect --->', stock)
					var sels = this.state.selected

					var idx = sels.indexOf(stock)
					sels.splice(idx, 1)
					this.setState({selected: sels})
				},
				renderSelectedList: function() {
					if (!this.state.selected.length)
						return <div><h4>Search and add a stock</h4></div>

					var list = this.state.selected.map(function(d) {
						return (<li onClick={this.handleStockUnSelection.bind(null, d)} title={'Remove ' + d.Name + ' (' + d.Exchange + ') from the selected list.'}>
							<span className='show-on-hover'>-</span>
							<span>{d.Symbol}</span>
						</li>)
					}.bind(this))

					var txt = 'Selection'
					if (this.state.selected.length > 1) txt += 's'
					return <div><h4>{this.state.selected.length} {txt}</h4><ul className='items hover pointer'>{list}</ul></div>
				},
				renderFoundList: function() {

					if (!this.state.founded.length)
						return <div></div>
						// return <div><h4>Not founded stocks</h4></div>

					var list = this.state.founded.map(function(d) {
						return (<li onClick={this.handleStockSelection.bind(null, d)} title={'Add ' + d.Name + ' (' + d.Exchange + ') to the selected list.'}>
							<span className='show-on-hover'>+</span>
							<span>{d.Symbol}</span>
						</li>)
					}.bind(this))

					return <div><h4>{this.state.founded.length} Found</h4><ul className='items hover pointer'>{list}</ul></div>
				},
				handleSearch: function(e) {
					e.preventDefault()
					var val = this.refs.searchText.getDOMNode().value

					var found = [
						{Symbol: 'NFLX1', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX2', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX3', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX4', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX5', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX6', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX7', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX8', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX9', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
						{Symbol: 'NFLX0', Name: 'Netflix Inc', Exchange: 'NASDAQ'},
					]

					this.setState({founded: found})

				},
				render: function() {

					var selectedList = this.renderSelectedList(),
						foundList = this.renderFoundList()

					return (<span>
						{selectedList}
						<form onSubmit={this.handleSearch}>
							<input ref='searchText' type="text" placeholder='Search for ...' />
						</form>
						{foundList}
					</span>)
				}
			})

			React.renderComponent(<Sidebar/>, document.getElementsByClassName('sidebar')[0])

		</script>

	</head>
	<body>
		
		<section class="topbar">
			<span class="project">&#8669; Stocks</span>
			<ul class='horizontal hover'>
				<li class='selected'> <a href="">Dashboard</a> </li>
				<li> <a href="">Table</a> </li>
				<li> <a href="">Graph</a> </li>
				<li> <a href="">Benchmark</a> </li>
				<li> <a href="">@</a> </li>
			</ul>
		</section>

		<section class="sidebar">
			<div>
				<h4>Selected</h4>
				<ul class='items hover pointer'>
					<li title='Remove Apple Inc (NASDAQ) from the selected list'>
						<span class='show-on-hover action'>-</span>
						<span>AAPL</span>
					</li>
					<li title='Remove Apple Inc (NASDAQ) from the selected list'>
						<span class='show-on-hover'>-</span>
						<span>AAPL</span>
					</li>
					<li title='Remove Apple Inc (NASDAQ) from the selected list'>
						<span class='show-on-hover'>-</span>
						<span>AAPL</span>
					</li>
				</ul>
			</div>
			<input type="text" placeholder='Search for ...'>
			<div>
				<h4>Found</h4>
				<ul class='items hover pointer'>
					<li title='Add Apple Inc (NASDAQ) to the selected list'>
						<span class='show-on-hover'>+</span>
						<span>AAPL</span>
					</li>
					<li title='Add Apple Inc (NASDAQ) to the selected list'>
						<span class='show-on-hover'>+</span>
						<span>AAPL</span>
					</li>
					<li title='Add Apple Inc (NASDAQ) to the selected list'>
						<span class='show-on-hover'>+</span>
						<span>AAPL</span>
					</li>
					<li title='Add Apple Inc (NASDAQ) to the selected list'>
						<span class='show-on-hover'>+</span>
						<span>AAPL</span>
					</li>
					<li title='Add Apple Inc (NASDAQ) to the selected list'>
						<span class='show-on-hover'>+</span>
						<span>AAPL</span>
					</li>
				</ul>
			</div>
		</section>

		<section class="middle">
			Uh!
		</section>

	</body>

</html>